---
title: "EWSFLI1 TurboID"
author: "Aiola Stoja"
date: "2023-08-14"
output: html_document
---
<style type="text/css">
   .main-container {max-width: 100%;}
   .row {display: flex;}
   .column {flex: 50%;}
</style>

```{r setup packages, include=FALSE}

library(readxl)
library("eulerr")
library("dplyr")
library("VennDiagram")
library(devtools)
#install_github("wjawaid/enrichR")
library(enrichR)
library(ggpubr)

```


```{r setup reading file, include=FALSE}

my_data <- as.list(read_xlsx("UniqueGenes.xlsx"))

naomit_mydata <- lapply(my_data, function(x) x[!is.na(x)])

```

# EWSFLI1 vs EWS TurboID Venn Diagram

```{r venn diagram ews vs ewsfli1 only, echo=FALSE, message=FALSE, warning=FALSE}

genes.venn <- euler(naomit_mydata)
plot(genes.venn, quantities = TRUE)

```

```{r extracting venn partitions, include=FALSE}

VennPartition<-get.venn.partitions(naomit_mydata) %>% dplyr::as_tibble()


listVennPartition <- setNames(as.list(VennPartition$..values..), VennPartition$..set..)


```


```{r setup enrichr , include=FALSE}

websiteLive <- getOption("enrichR.live")
if (websiteLive) {
    listEnrichrSites()
    setEnrichrSite("Enrichr") # Human genes   
}

if (websiteLive) dbs <- listEnrichrDbs()

dbs <- c("GO_Molecular_Function_2015", "GO_Cellular_Component_2015", "GO_Biological_Process_2015")

if (websiteLive) {
    enrichedEWSxEWSFLI1 <- enrichr(listVennPartition[["EWS∩EWS::FLI1"]], dbs)
}

if (websiteLive) {
    enrichedEWSFLI1 <- enrichr(listVennPartition[["(EWS::FLI1)∖(EWS)"]], dbs)
}

if (websiteLive) {
    enrichedEWS <- enrichr(listVennPartition[["(EWS)∖(EWS::FLI1)"]], dbs)
}



```

<div class = "row">
<div class = "column">

## EWSFLI1 and EWS shared gene GO terms {.tabset}

### Biological Process

```{r enrichr EWSxEWSFLI1 Biological Process , echo=FALSE, message=FALSE, warning=FALSE}


#Biological Process

if (websiteLive) {
    plotEnrich(enrichedEWSxEWSFLI1$GO_Biological_Process_2015, showTerms = 20, numChar = 40, y = "Count", orderBy = "P.value", title = "EWS and EWSFLI1 shared Enrichr: GO Biolog Process")
}
```

### Molecular Function

```{r enrichr EWSxEWSFLI1 Molecular Function , echo=FALSE, message=FALSE, warning=FALSE}

#Molecular Function

if (websiteLive) {
    plotEnrich(enrichedEWSxEWSFLI1$GO_Molecular_Function_2015, showTerms = 20, numChar = 40, y = "Count", orderBy = "P.value", title = "EWS and EWSFLI1 shared Enrichr: GO Molec Function")
}
```

### Cellular component

```{r enrichr EWSxEWSFLI1 Cellular Component, echo=FALSE, message=FALSE, warning=FALSE}
#Cellular component

if (websiteLive) {
    plotEnrich(enrichedEWSxEWSFLI1$GO_Cellular_Component_2015, showTerms = 20, numChar = 40, y = "Count", orderBy = "P.value", title = "EWS and EWSFLI1 shared Enrichr:GO Cell Component")
}

```

</div>

<div class = "column">

## EWSFLI1 unique gene GO terms {.tabset}

### Biological Process

```{r enrichr EWSFLI1 only Biological Process, echo=FALSE, message=FALSE, warning=FALSE}

#Biological Process
if (websiteLive) {
    plotEnrich(enrichedEWSFLI1$GO_Biological_Process_2015, showTerms = 20, numChar = 40, y = "Count", orderBy = "P.value", title = "EWSFLI1 Enrichr: Go Biolog Process")
}

```

### Molecular Function

```{r enrichr EWSFLI1 only Molecular Function, echo=FALSE, message=FALSE, warning=FALSE}
#Molecular Function
if (websiteLive) {
    plotEnrich(enrichedEWSFLI1$GO_Molecular_Function_2015, showTerms = 20, numChar = 40, y = "Count", orderBy = "P.value", title = "EWSFLI1 Enrichr: GO Molec Function")
}

```

### Cellular Component 

```{r enrichr EWSFLI1 only Cellular Component, echo=FALSE, message=FALSE, warning=FALSE}
#Cellular component
if (websiteLive) {
    plotEnrich(enrichedEWSFLI1$GO_Cellular_Component_2015, showTerms = 20, numChar = 40, y = "Count", orderBy = "P.value", "EWSFLI1 Enrichr: GO Cell Component")
}

```

## EWS unique gene GO terms {.tabset}

### Biological Process

```{r enrichr EWS only Biological process, echo=FALSE, message=FALSE, warning=FALSE}

#Biological Process
if (websiteLive) {
    plotEnrich(enrichedEWS$GO_Biological_Process_2015, showTerms = 20, numChar = 40, y = "Count", orderBy = "P.value", title = "EWS Enrichr: GO Biological Process")
}

```

### Molecular Function

```{r enrichr EWS only Molecular Function, echo=FALSE, message=FALSE, warning=FALSE}

#Molecular Function
if (websiteLive) {
    plotEnrich(enrichedEWS$GO_Molecular_Function_2015, showTerms = 20, numChar = 40, y = "Count", orderBy = "P.value", title = "EWS Enrichr: GO Molec Function")
}

```

### Cellular Component

```{r enrichr EWS only Cellular Component, echo=FALSE, message=FALSE, warning=FALSE}

#Cellular component
if (websiteLive) {
    plotEnrich(enrichedEWS$GO_Cellular_Component_2015, showTerms = 20, numChar = 40, y = "Count", orderBy = "P.value", title = "EWS Enrichr: GO Cell Component")
}

```

</div>
</div>
